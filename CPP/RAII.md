---
title: RAII
categories: CPP
tags:
	- CPP
---



# RAII

RAII（Resource Acquisition Is Initialization）资源获取即初始化，其是一种将资源的生命周期绑定至对象生命周期的技术。这些资源指诸如分配的堆内存，执行中的线程，socket，文件，锁，磁盘空间，数据库连接，此类的有限资源。

”对象管理资源”的观念常被称为"资源取得时机便是初始化时机"，因为我们几乎总是在获得一笔资源后于同一时间内以它初始化某个管理对象。对于每一笔资源，其都在获取的同时立即被放进管理对象。

RAII保证对于可以访问资源管理对象的任何函数，其资源一定可用。其同样保证当控制对象终结时，其所有资源都会以获取的相反顺序被释放。同样，如果资源获取失败（构造函数因为异常退出），所有完全构造的成员变量获取到的资源和基类子对象会被以相反的初始化顺序进行释放。RAII利用了语言的核心特性（对象生命周期、范围退出、初始化顺序和栈解退）去消除资源泄漏并保证异常安全。此技术常也被称为SBRM（Scope-Bound Resource Management），因为一般的使用示例都是RAII对象由于范围退出导致终结。

RAII可以被总结为如下：

* 将每个资源都封装到类中：

 1、 构造函数获取资源并且构造所有的类常量或者当无法完成时抛出一个异常。

 2、析构函数释放资源并从不抛出异常

- 使用资源时通过RAII-class实例获取、

 1、RAII-class 是自动或临时生命周期

 2、生命周期绑定到自动或临时对象的生命周期



### 初始化顺序

成员初始化顺序与成员初始化列表的顺序并不相关，其实际初始化顺序如下：

1）对于多派生类的构造函数，虚继承以最深、从左至右的继承声明顺序为初始化顺序。

2）之后，直接基类以从左至右的声明顺序进行初始化

3）之后，non-static数据成员以类中的声明顺序进行初始化。

4）最终，构造函数的函数体被执行


